/**
 * jquery.bootstrap-chooser - A multiple token selector using Bootstrap styling.
 * @version v1.0.1
 * @link https://github.com/justinchmura/jquery.bootstrap-chooser
 * @license MIT
 */
!function(o){"use strict";o.chooser=function(e,t){var n=this;n.$el=o(e),n.el=e,n.$el.data("chooser",n),n.selected=[],n.public={},n.init=function(){n.options=o.extend({},o.chooser.defaultOptions,t),n.$el.addClass("bootstrap-chooser"),o.isArray(n.options.data)?n.data=n.options.data:o.isFunction(n.options.data)&&(n.data=n.options.data()),n.unfiltered=n.data.slice(),n._createSearchField(),n._createDropdown(),n.$control.on("click.bootstrap-chooser",function(){n.$control.addClass("active"),n.$input.focus(),n.$dropdown.addClass("active")}),n.$dropdown.on("click.bootstrap-chooser","li.option",function(){n._addSelection(o(this)),n._closeDropdown()}),n.$control.on("click.bootstrap-chooser",".choice button.close",function(e){var t=o(this).data("index");console.log(o(this).data("index"));for(var l=n.selected.length-1;l>=0;l-=1)n.selected[l].index===t&&n.selected.splice(l,1);return n._applySelected(),e.preventDefault(),!1}),n.$control.on("input","li.search-field input",function(){var e=o(this).val();n._search(e)}),o(document).on("click.bootstrap-chooser",function(e){n.$el.is(o(e.target).closest(".bootstrap-chooser"))||n._closeDropdown()})},n.public.update=function(e){if(o.isArray(e))n.data=e.slice();else{if(!o.isFunction(e))return;n.data=e()}n.$input.val().length>0&&n.$input.val(""),n.unfiltered=n.data.slice(),n._closeDropdown(),n.selected=[],n._applySelected(),n._resetDropdown()},n.public.destroy=function(){n._closeDropdown(),n.selected=[],n._applySelected(),n.$control.off("click.bootstrap-chooser"),n.$dropdown.off("click.bootstrap-chooser","li.choice"),n.$control.off("click.bootstrap-chooser",".choice button.close"),n.$control.removeClass("form-control"),n.$el.removeClass("chooser"),n.$el.removeData("plugins.bootstrap-chooser"),n.$el.html(""),o(document).off("click.bootstrap-chooser")},n.public.selections=function(){return n.selected},n._applySelected=function(){o("li.choice",n.$control).remove(),n.selected.forEach(function(e){var t=o("<button/>").attr({type:"button","class":"close","aria-hidden":"true"}).data("index",e.index).html("&times;"),l=o("<span/>").addClass("label label-"+n.options.labelClass).text(e.text),s=o("<li/>").addClass("choice").data("index",e.index);t.appendTo(l),l.appendTo(s),s.insertBefore(o("li.search-field",n.$control))}),o("li",n.$dropdown).removeClass("chosen").addClass("option").each(function(){var e=o(this).data("index"),t=o(this);n.selected.forEach(function(o){o.index===e&&t.removeClass("option").addClass("chosen")})})},n._addSelection=function(e){var t,l;(!n.options.max||n.selected.length<n.options.max)&&(l=e.text(),l&&(t=n.unfiltered.indexOf(l),-1!==t&&(n.selected.push({index:t,text:n.unfiltered[t]}),n.$input.val().length>0&&(n.$input.val(""),n.data=n.unfiltered.slice(),n._resetDropdown()),n._applySelected(),o.isFunction(n.options.select)&&n.options.select())))},n._createSearchField=function(){n.$el.html("<div class='bootstrap-chooser-control form-control'><ul><li class='search-field'></li></ul></div>"),o("<input/>").attr({type:"search",placeholder:n.options.placeholder,autocomplete:"off"}).appendTo(o("li.search-field",n.$el))},n._search=function(e){n.data=n.unfiltered.slice(),e.length>0?(e=e.toLowerCase(),n.data=n.data.filter(function(o){return-1!==o.toLowerCase().indexOf(e)})):n.data=n.unfiltered.slice(),n._resetDropdown(),o("li",n.$dropdown).each(function(){var e=o(this).text();-1!==n.selected.map(function(o){return o.text}).indexOf(e)&&o(this).removeClass("option").addClass("chosen")})},n._createDropdown=function(){n.$control=o(".bootstrap-chooser-control",n.$el),n.$input=o("li.search-field input",n.$control),o("<div/>").html("<ul></ul>").addClass("bootstrap-chooser-dropdown").insertAfter(n.$control),n.$dropdown=o(".bootstrap-chooser-dropdown",n.$el),n.$dropdown.hide(),n._resetDropdown()},n._resetDropdown=function(){o("ul",n.$dropdown).html(""),n.data.forEach(function(e,t){o("<li/>").text(e).data("index",t).addClass("option").appendTo(o("ul",n.$dropdown))})},n._closeDropdown=function(){n.$control.removeClass("active"),n.$dropdown.removeClass("active")},n.init()},o.chooser.defaultOptions={placeholder:"Choose...",labelClass:"info",data:[],max:null,select:null},o.fn.chooser=function(e){var t,n=Array.prototype.slice.call(arguments,0),l=this.each(function(){var l=o(this),s=l.data("plugins.bootstrap-chooser"),c="object"==typeof e&&e;(s||"destroy"!==e)&&(s?"string"==typeof e&&(n.splice(0,1),t=s.public[e].apply(s,n)):l.data("plugins.bootstrap-chooser",new o.chooser(this,c)))});return"string"==typeof e?t:l}}(window.jQuery);